<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>GPD | ARCHIVIST v21.9 MASTER</title>
    <style>
        :root { 
            --bg: #030507; --glass: rgba(10, 15, 20, 0.98); --border: #1a2a3a; 
            --accent: #00f2ff; --success: #00ff95; --danger: #ff3c3c; --text: #a0c4d1; --warn: #ffcc00;
        }
        body { 
            background: var(--bg); color: var(--text); font-family: 'Courier New', monospace; 
            padding: 10px; margin: 0; background-image: radial-gradient(circle at 50% 50%, #0d1a21 0%, #05080a 100%);
        }
        .hud-container { max-width: 600px; margin: auto; display: flex; flex-direction: column; gap: 15px; }
        .module { 
            background: var(--glass); border: 1px solid var(--border); padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.8); border-top: 2px solid var(--accent);
        }
        h2 { color: var(--accent); font-size: 0.9rem; text-transform: uppercase; letter-spacing: 2px; margin: 0 0 15px 0; border-bottom: 1px solid var(--border); padding-bottom: 5px;}
        label { display: block; font-size: 0.65rem; color: var(--accent); margin-bottom: 5px; text-transform: uppercase; }
        input { 
            background: rgba(0,0,0,0.8); border: 1px solid var(--border); color: #fff; 
            padding: 12px; width: 100%; box-sizing: border-box; font-size: 16px !important; border-radius: 2px; margin-bottom: 5px;
        }
        .btn { 
            background: none; border: 1px solid var(--accent); color: var(--accent); 
            padding: 12px; cursor: pointer; text-transform: uppercase; font-weight: bold; font-size: 0.8rem;
        }
        .btn-log { background: var(--success); color: #000; border: none; width: 150px; font-size: 1rem; }
        .btn-dispose { border: 1px solid var(--danger); color: var(--danger); padding: 5px; font-size: 0.6rem; margin-top: 10px; width: 100%; }
        .log-entry { background: rgba(0,0,0,0.4); border: 1px solid var(--border); padding: 12px; margin-bottom: 10px; border-left: 4px solid var(--accent); font-size: 0.75rem; }
    </style>
</head>
<body>

<div class="hud-container">
    <div class="module">
        <h2>[ COMMAND TERMINAL ]</h2>
        <div style="display:flex; gap:10px;">
            <div style="flex:1">
                <label>OFFICER</label>
                <input type="text" id="officer" placeholder="Badge ID" onchange="localStorage.setItem('gpd_ofc', this.value)">
            </div>
            <div style="flex:1">
                <label>SUSPECT</label>
                <input type="text" id="suspect" placeholder="Subject Name">
            </div>
        </div>
        <label>EVIDENCE INPUT</label>
        <input type="text" id="asset" placeholder="Item Name...">
        <button class="btn" style="width:100%; margin-top:5px; background:var(--accent); color:#000;" onclick="add()">ADD TO MANIFEST</button>
    </div>

    <div class="module">
        <h2>[ SEIZURE MANIFEST ]</h2>
        <div id="locker"></div>
        <div style="display:flex; justify-content:space-between; align-items:center; margin-top:15px; border-top: 1px solid var(--border); padding-top:10px;">
            <span id="total" style="font-size:1.5rem; color:var(--success);">READY</span>
            <button class="btn btn-log" onclick="log()">LOG CASE</button>
        </div>
    </div>

    <div class="module">
        <h2>[ GLOBAL PRECINCT ARCHIVES ]</h2>
        <div id="archives">SYNCING...</div>
    </div>
</div>

<script>
    const API = "https://sheetdb.io/api/v1/sn9w3fnrrq26j";
    let manifest = [];

    window.onload = () => {
        document.getElementById('officer').value = localStorage.getItem('gpd_ofc') || '';
        load();
    };

    function add() {
        const val = document.getElementById('asset').value;
        if(val) manifest.push(val);
        document.getElementById('asset').value = '';
        renderLocker();
    }

    function renderLocker() {
        const box = document.getElementById('locker');
        box.innerHTML = manifest.map((item, i) => `<div style="padding:5px; border-bottom:1px solid #111;">${item} <span style="float:right; color:var(--danger);" onclick="manifest.splice(${i},1);renderLocker()">X</span></div>`).join('');
    }

    async function log() {
        const o = document.getElementById('officer').value;
        const s = document.getElementById('suspect').value;
        if(!o || !s || manifest.length === 0) return alert("INCOMPLETE DATA");

        try {
            await fetch(API, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({ data: [{ officer: o, suspect: s, timestamp: manifest.join(', ') }] })
            });
            manifest = []; renderLocker(); document.getElementById('suspect').value = '';
            load();
        } catch (e) { alert("SYNC ERROR"); }
    }

    async function dispose(susName) {
        if(!confirm("DELETE PERMANENTLY?")) return;
        try {
            await fetch(`${API}/suspect/${susName}`, { method: 'DELETE' });
            load();
        } catch (e) { alert("FAILED"); }
    }

    async function load() {
        const box = document.getElementById('archives');
        try {
            const res = await fetch(API);
            const data = await res.json();
            box.innerHTML = data.reverse().map(row => `
                <div class="log-entry">
                    <div style="color:var(--accent); font-size:0.6rem;">${row.officer || 'UNKN'} | ${new Date().toLocaleDateString()}</div>
                    <div style="font-weight:bold; margin:5px 0;">SUSPECT: ${row.suspect || 'UNKN'}</div>
                    <div style="opacity:0.7;">${row.timestamp || 'No Items'}</div>
                    <button class="btn btn-dispose" onclick="dispose('${row.suspect}')">DISPOSE RECORD</button>
                </div>
            `).join('');
        } catch (e) { box.innerHTML = "CONNECTION ERROR"; }
    }
</script>
</body>
</html>
