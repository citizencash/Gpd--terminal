<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GPD | GLOBAL MAIN TERMINAL</title>
    <style>
        :root { --gpd-blue: #00f2ff; --gpd-red: #ff0044; --gpd-dark: #030507; --gpd-border: #004c54; }
        body { background: var(--gpd-dark); color: var(--gpd-blue); font-family: 'Courier New', monospace; margin: 0; padding: 15px; text-transform: uppercase; }
        
        /* Flashing Emergency Header */
        .header { border: 2px solid var(--gpd-border); padding: 20px; text-align: center; margin-bottom: 20px; background: #050a10; position: relative; border-left: 8px solid var(--gpd-red); animation: border-flash 1.5s infinite; }
        @keyframes border-flash { 0%, 100% { border-left-color: var(--gpd-red); } 50% { border-left-color: var(--gpd-blue); } }

        .container { border: 2px solid var(--gpd-border); padding: 15px; background: #050a10; margin-bottom: 20px; box-shadow: 0 0 15px rgba(0, 242, 255, 0.1); }
        h3 { margin-top: 0; border-bottom: 1px solid var(--gpd-border); padding-bottom: 10px; color: #fff; letter-spacing: 2px; }
        
        input { background: #000; border: 1px solid var(--gpd-border); color: #fff; width: 100%; padding: 15px; margin-bottom: 15px; box-sizing: border-box; font-family: 'Courier New', monospace; font-size: 1rem; outline: none; }
        input:focus { border-color: var(--gpd-blue); box-shadow: 0 0 10px rgba(0, 242, 255, 0.3); }
        
        button { background: #007a8b; border: none; color: #fff; width: 100%; padding: 20px; font-weight: bold; font-size: 1.1rem; cursor: pointer; text-transform: uppercase; letter-spacing: 2px; transition: 0.2s; }
        button:active { background: var(--gpd-blue); color: #000; transform: scale(0.98); }

        /* Archive Styling */
        .archive-box { background: #000; border: 1px solid #111; padding: 10px; font-size: 0.85rem; max-height: 400px; overflow-y: auto; }
        .log-entry { border-bottom: 1px solid #1a1a1a; padding: 12px 0; color: #888; }
        .log-entry b { color: var(--gpd-blue); }
        .log-time { color: #444; font-size: 0.75rem; display: block; margin-bottom: 4px; }
    </style>
</head>
<body>

    <div class="header">
        <h1 style="margin:0; font-size: 1.8rem;">G.P.D. TERMINAL</h1>
        <div style="font-size: 0.7rem; margin-top: 5px; color: #aaa;">SYSTEM STATUS: <span style="color: #0f0;">ENCRYPTED & ONLINE</span></div>
    </div>

    <div class="container">
        <h3>[ FIELD REPORT ]</h3>
        <input type="text" id="off_name" placeholder="OFFICER CALLSIGN">
        <input type="text" id="sus_name" placeholder="SUSPECT IDENTIFICATION">
        <button onclick="logCase()">COMMIT TO GLOBAL LOG</button>
    </div>

    <div class="container">
        <h3>[ GLOBAL DATABASE ]</h3>
        <div id="archive-list" class="archive-box">ESTABLISHING SECURE CONNECTION...</div>
    </div>

    <script>
        // Your verified connection from the test
        const API_URL = "https://sheetdb.io/api/v1/sn9w3fnrrq26j";

        async function logCase() {
            const o = document.getElementById('off_name').value.trim();
            const s = document.getElementById('sus_name').value.trim();
            if(!o || !s) return alert("REQUIRED: OFFICER AND SUSPECT NAMES");

            try {
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        data: [{ "officer": o, "suspect": s, "timestamp": new Date().toLocaleString() }]
                    })
                });
                if(response.ok) {
                    alert("LOG SECURED: " + o + " REPORTED " + s);
                    location.reload();
                }
            } catch (e) { alert("CONNECTION ERROR: DATABASE OFFLINE"); }
        }

        async function loadArchive() {
            try {
                const res = await fetch(API_URL);
                const data = await res.json();
                if(data.length > 0) {
                    // Filter out bad data and display
                    document.getElementById('archive-list').innerHTML = data.reverse()
                    .filter(c => c.officer && c.suspect)
                    .map(c => `
                        <div class="log-entry">
                            <span class="log-time">${c.timestamp || "NEW RECORD"}</span>
                            OFFICER <b>${c.officer}</b> BUSTED <b>${c.suspect}</b>
                        </div>
                    `).join('');
                } else {
                    document.getElementById('archive-list').innerHTML = "NO RECORDS FOUND IN GLOBAL SYSTEM";
                }
            } catch (e) { document.getElementById('archive-list').innerHTML = "SYSTEM CONNECTION ERROR"; }
        }
        window.onload = loadArchive;
    </script>
</body>
</html>
